# 02-页面渲染流程

![渲染流程](../images/zen/reflow-01.svg)

==TODO==

## 重排重绘

重排（reflow）：浏览器第一次渲染页面布局后，后续引起页面各个元素节点在页面所处位置的重新计算、重新布局。

重绘（repaint）：布局完成后，页面重新绘制，这时浏览器会遍历渲染树，绘制每个节点

重排一定会引起重绘。

涉及页面布局、位置改变，都会触发重排，如：offset 系列、scroll 系列、client 系列、resize。此外设置元素的 display 也会引起。

只改变颜色、背景、显示/隐藏（位置不变）只会引起重绘，如：visibility、outline、color、background。

不断的改变位置等触发重排、重绘，会造成性能损失，优化方案：先映射一个虚拟 DOM，对其进行操作，所有操作完毕后，才显示 DOM，可以极大限度减少重排、重绘次数。

## 并发请求数

浏览器同一时间内最多并发 6 个请求。

虽然 JS 是单线程+异步队列的工作模式，但是浏览器的渲染任务存储在 UI Queue 队列，JS 的加载解析并不会影响 UIQueue 任务队列，但在运行时会将任务添加到 UIQueue 中，从而阻塞浏览器的渲染，特别是涉及一些密集运算影响更大，如：地图三维模型点位置运算。此时可以采用 worker 机制。
